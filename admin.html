<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Panel de Administración</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <h1>Panel de Administración</h1>
    <p>Escribe aquí el nuevo contenido HTML del index:</p>
    <textarea id="newContent" rows="15" cols="100"></textarea><br />
    <button onclick="updateIndex()">Actualizar sitio</button>
  </div>

  <script>
  async function updateIndex() {
    const token = prompt("Pega aquí tu token de GitHub:");
    const repo = prompt("Ingresa tu usuario/repositorio (ej: usuario/mi-sitio):");
    const filePath = "index.html";

    const newContent = document.getElementById('newContent').value;
    const contentBase64 = btoa(unescape(encodeURIComponent(newContent)));

    const fileData = await fetch(`https://api.github.com/repos/${repo}/contents/${filePath}`, {
      headers: { Authorization: `token ${token}` }
    }).then(r => r.json());

    await fetch(`https://api.github.com/repos/${repo}/contents/${filePath}`, {
      method: "PUT",
      headers: {
        Authorization: `token ${token}`,
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        message: "Actualización desde admin.html",
        content: contentBase64,
        sha: fileData.sha
      })
    });

    alert("Sitio actualizado. Vercel publicará los cambios automáticamente.");
  }
  </script>
</body>
</html>
